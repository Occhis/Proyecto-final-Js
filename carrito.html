<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrito de Compras - E-Commerce</title>
    <link rel="stylesheet" href="style.css">
    <!-- SweetAlert2 CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/11.10.1/sweetalert2.all.min.js"></script>
</head>
<body>

    <header>
    <div class="navbar-container">
        <h1>üõí Carrito de Compras</h1>
        <nav class="nav-links">
            <a class="nav-link" href="index.html">‚Üê Seguir Comprando</a>
            <div class="carrito-contador">
                <span id="contador-carrito">0</span>
            </div>
        </nav>
    </div>
</header>
    <!-- Productos en el carrito -->
    <div id="carrito"></div>

    <!-- Secci√≥n de cupones -->
    <div class="cupon-section" id="cupon-section" style="display: none;">
        <h3>¬øTienes un cup√≥n de descuento?</h3>
        <div id="seccion-cupon">
            <div class="cupon-input">
                <input type="text" id="input-cupon" placeholder="C√≥digo de cup√≥n (ej: DESCUENTO10)">
                <button onclick="aplicarCupon()" class="btn-aplicar-cupon">Aplicar</button>
            </div>
        </div>
    </div>

    <!-- Resumen de compra -->
    <div class="total-container">
        <div class="resumen-compra">
            <h3>Resumen de compra</h3>
            <div class="linea-total">
                <span>Subtotal:</span>
                <span>$<span id="subtotal">0.00</span></span>
            </div>
            <div class="linea-total descuento-row" style="display: none;">
                <span>Descuento:</span>
                <span class="descuento">-$<span id="descuento">0.00</span></span>
            </div>
            <div class="linea-total">
                <span>Impuestos:</span>
                <span>$<span id="impuestos">0.00</span></span>
            </div>
            <div class="linea-total envio-row">
                <span>Env√≠o:</span>
                <span id="envio">$0.00</span>
            </div>
            <hr>
            <div class="linea-total total-final">
                <strong>Total: $<span id="total">0.00</span></strong>
            </div>
        </div>
        <button class="vaciar-btn" id="vaciarCarrito">üóëÔ∏è Vaciar Carrito</button>
    </div>

    <!-- Secci√≥n de checkout -->
    <div id="checkout-section" class="checkout-section" style="display: none;">
        <div class="checkout-container">
            <div class="checkout-column">
                <h3>üìã Datos de entrega</h3>
                <form id="form-checkout" class="form-checkout">
                    <div class="form-group">
                        <label for="nombre">Nombre completo:</label>
                        <input type="text" id="nombre" name="nombre" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="email">Email:</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="telefono">Tel√©fono:</label>
                        <input type="tel" id="telefono" name="telefono" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="direccion">Direcci√≥n:</label>
                        <input type="text" id="direccion" name="direccion" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="ciudad">Ciudad:</label>
                            <input type="text" id="ciudad" name="ciudad" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="codigo-postal">C√≥digo postal:</label>
                            <input type="text" id="codigo-postal" name="codigo-postal" required>
                        </div>
                    </div>
                </form>
            </div>

            <div class="checkout-column">
                <h3>üí≥ M√©todo de pago</h3>
                <div id="metodos-pago" class="metodos-pago">
                    <!-- Los m√©todos de pago se cargar√°n din√°micamente desde config.json -->
                </div>
                
                <div class="finalizar-compra">
                    <button onclick="finalizarCompra()" class="btn-finalizar-compra">
                        üí≥ Finalizar Compra
                    </button>
                    <p class="seguridad-info">
                        üîí Compra 100% segura y protegida
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script src="carrito.js"></script>
    
    <script>
        // Mostrar secci√≥n de cupones cuando hay productos en el carrito
        document.addEventListener('DOMContentLoaded', function() {
            const observer = new MutationObserver(function(mutations) {
                const carrito = JSON.parse(localStorage.getItem("carrito")) || [];
                const cuponSection = document.getElementById("cupon-section");
                if (cuponSection) {
                    cuponSection.style.display = carrito.length > 0 ? "block" : "none";
                }
            });
            
            observer.observe(document.getElementById("carrito"), { 
                childList: true, 
                subtree: true 
            });
        });
    </script>
</body>
</html>